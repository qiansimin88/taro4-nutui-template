# ç™»å½•é‰´æƒæ¶æ„æŒ‡å—

## æ¶æ„æ¦‚è§ˆ

æœ¬é¡¹ç›®é‡‡ç”¨**é™é»˜ç™»å½• + åˆ†å±‚é‰´æƒ**çš„ç°ä»£åŒ–ç™»å½•æ–¹æ¡ˆï¼Œç”¨æˆ·æ— éœ€ä¸»åŠ¨è·³è½¬ç™»å½•é¡µå³å¯å®Œæˆèº«ä»½è®¤è¯ã€‚

### æ ¸å¿ƒç‰¹ç‚¹

- âœ… **è€ç”¨æˆ·æ— æ„ŸçŸ¥**ï¼šè‡ªåŠ¨é™é»˜ç™»å½•ï¼Œç›´æ¥è¿›å…¥åº”ç”¨
- âœ… **æ–°ç”¨æˆ·å³æ—¶æˆæƒ**ï¼šåœ¨ä¸šåŠ¡æ“ä½œç‚¹è§¦å‘æ‰‹æœºå·æˆæƒ
- âœ… **åˆ†å±‚é‰´æƒè®¾è®¡**ï¼šæŒ‰é’®åœºæ™¯ç”¨ç»„ä»¶ï¼ŒéæŒ‰é’®åœºæ™¯ç”¨ Hook
- âœ… **å¼€å‘æ•ˆç‡é«˜**ï¼šçµæ´»é€‰æ‹©ï¼Œé€‚åº”å¤šç§åœºæ™¯
- âœ… **ç”¨æˆ·ä½“éªŒä½³**ï¼šæŒ‰é’®æ— è·³è½¬ï¼Œå…¶ä»–å…ƒç´ ç»Ÿä¸€å…¥å£

### é‰´æƒåœºæ™¯åˆ†å±‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           é‰´æƒåœºæ™¯åˆ†å±‚                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                       â”‚
â”‚  âœ… æŒ‰é’®åœºæ™¯                            â”‚
â”‚     â””â”€ ä½¿ç”¨ AuthButton ç»„ä»¶            â”‚
â”‚        â””â”€ ä¼˜ç‚¹: ç›´æ¥åœ¨å½“å‰é¡µæˆæƒ,ä½“éªŒæµç•…  â”‚
â”‚                                       â”‚
â”‚  âœ… éæŒ‰é’®åœºæ™¯ (Image/View/ListItemç­‰)  â”‚
â”‚     â””â”€ ä½¿ç”¨ useAuth Hook               â”‚
â”‚        â””â”€ æµç¨‹: æ£€æµ‹æœªç™»å½• â†’ å¼¹çª—æç¤º â†’    â”‚
â”‚                  è·³è½¬ç™»å½•é¡µ â†’ AuthButtonæˆæƒ â†’â”‚
â”‚                  è¿”å›åŸé¡µé¢                   â”‚
â”‚                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## useAuth Hook â­ï¸

### ä»€ä¹ˆæ—¶å€™ä½¿ç”¨

å½“ä½ éœ€è¦åœ¨**éæŒ‰é’®å…ƒç´ **ä¸Šæ·»åŠ é‰´æƒæ—¶ï¼Œä½¿ç”¨ `useAuth` Hookï¼š

- âœ… å›¾ç‰‡ç‚¹å‡»æŸ¥çœ‹å¤§å›¾
- âœ… List Item ç‚¹å‡»è·³è½¬è¯¦æƒ…
- âœ… View å®¹å™¨ç‚¹å‡»äº‹ä»¶
- âœ… è‡ªå®šä¹‰ç»„ä»¶çš„é‰´æƒé€»è¾‘
- âœ… éœ€è¦çµæ´»æ§åˆ¶çš„å¤æ‚åœºæ™¯

### åŸºç¡€ç”¨æ³•

```tsx
import { View, Image } from "@tarojs/components";
import { useAuth } from "@/hooks";
import Taro from "@tarojs/taro";

function Gallery() {
  const { checkAuth } = useAuth();

  const handleImageClick = async () => {
    // è‡ªåŠ¨æ£€æŸ¥ç™»å½•çŠ¶æ€
    await checkAuth(() => {
      // ç™»å½•åæ‰§è¡Œçš„ä¸šåŠ¡é€»è¾‘
      Taro.previewImage({
        urls: ["https://example.com/image.jpg"],
      });
    });
  };

  return <Image onClick={handleImageClick} src="..." />;
}
```

### å·¥ä½œæµç¨‹

```
ç”¨æˆ·ç‚¹å‡»å…ƒç´ 
  â†“
è°ƒç”¨ checkAuth()
  â†“
åˆ¤æ–­æ˜¯å¦å·²ç™»å½•
  â”‚
  â”œâ”€ âœ… å·²ç™»å½• â†’ ç›´æ¥æ‰§è¡Œå›è°ƒ
  â”‚
  â””â”€ âŒ æœªç™»å½• â†’ å¼¹çª—æç¤º â€œéœ€è¦ç™»å½•â€
                â†“
          ç”¨æˆ·ç‚¹å‡»â€œå»ç™»å½•â€
                â†“
          è·³è½¬åˆ°ç™»å½•é¡µ (/pages/login/index)
                â†“
          ç”¨æˆ·ç‚¹å‡»â€œæ‰‹æœºå·å¿«æ·ç™»å½•â€(AuthButton)
                â†“
          æˆæƒæˆåŠŸ
                â†“
          è‡ªåŠ¨è¿”å›åŸé¡µé¢
```

### å®Œæ•´ç¤ºä¾‹

#### ç¤ºä¾‹ 1ï¼šå›¾ç‰‡ç‚¹å‡»

```tsx
import { Image } from "@tarojs/components";
import { useAuth } from "@/hooks";
import Taro from "@tarojs/taro";

function ProductGallery({ images }) {
  const { checkAuth } = useAuth();

  const handlePreview = async (index: number) => {
    await checkAuth(() => {
      Taro.previewImage({
        urls: images,
        current: images[index],
      });
    });
  };

  return (
    <View className="gallery">
      {images.map((img, idx) => (
        <Image key={idx} src={img} onClick={() => handlePreview(idx)} />
      ))}
    </View>
  );
}
```

#### ç¤ºä¾‹ 2ï¼šList Item ç‚¹å‡»

```tsx
import { View, Text } from "@tarojs/components";
import { useAuth } from "@/hooks";
import { nav } from "@/utils/nav";

function OrderList({ orders }) {
  const { checkAuth } = useAuth();

  const handleItemClick = async (orderId: string) => {
    await checkAuth(() => {
      // è·³è½¬è®¢å•è¯¦æƒ…
      nav.to(`/pages/orderDetail/index?id=${orderId}`);
    });
  };

  return (
    <View>
      {orders.map((order) => (
        <View
          key={order.id}
          onClick={() => handleItemClick(order.id)}
          className="order-item"
        >
          <Text>{order.title}</Text>
        </View>
      ))}
    </View>
  );
}
```

#### ç¤ºä¾‹ 3ï¼šå¤æ‚é€»è¾‘æ§åˆ¶

```tsx
import { useAuth } from "@/hooks";
import Taro from "@tarojs/taro";

function CommentBox() {
  const { isAuthenticated, checkAuth } = useAuth();
  const [comment, setComment] = useState("");

  // æ–¹å¼ 1ï¼šå…ˆæ£€æŸ¥ï¼Œå†æ‰§è¡Œ
  const handleSubmit1 = async () => {
    if (!isAuthenticated) {
      Taro.showToast({ title: "è¯·å…ˆç™»å½•", icon: "none" });
      return;
    }
    await submitComment(comment);
  };

  // æ–¹å¼ 2ï¼šè‡ªåŠ¨æ£€æŸ¥å¹¶æ‰§è¡Œ
  const handleSubmit2 = async () => {
    await checkAuth(async () => {
      await submitComment(comment);
    });
  };

  return (
    <View>
      <Textarea value={comment} onInput={(e) => setComment(e.detail.value)} />
      <Button onClick={handleSubmit2}>å‘è¡¨è¯„è®º</Button>
    </View>
  );
}
```

### API è¯´æ˜

#### checkAuth(callback?)

æ£€æŸ¥é‰´æƒå¹¶æ‰§è¡Œå›è°ƒã€‚

**å‚æ•°**:

- `callback?: () => void | Promise<void>` - ç™»å½•æˆåŠŸåæ‰§è¡Œçš„å›è°ƒå‡½æ•°

**è¿”å›**:

- `Promise<boolean>` - `true` è¡¨ç¤ºå·²ç™»å½•ï¼Œ`false` è¡¨ç¤ºæœªç™»å½•

#### isAuthenticated

å½“å‰æ˜¯å¦å·²ç™»å½•çš„å¸ƒå°”å€¼ã€‚

**ç±»å‹**: `boolean`

---

## é€‰æ‹© AuthButton è¿˜æ˜¯ useAuthï¼Ÿ

### âœ… ä½¿ç”¨ AuthButton çš„åœºæ™¯

- æ‰€æœ‰**æŒ‰é’®ç‚¹å‡»**æ“ä½œ
- éœ€è¦**ç›´æ¥åœ¨å½“å‰é¡µæˆæƒ**çš„åœºæ™¯
- å¸Œæœ›**æ— è·³è½¬ã€æµç•…ä½“éªŒ**çš„åœºæ™¯

**ç¤ºä¾‹**:

```tsx
// âœ… æ¨èï¼šæŒ‰é’®åœºæ™¯ä½¿ç”¨ AuthButton
<AuthButton onClick={handleBuy}>ç«‹å³è´­ä¹°</AuthButton>
<AuthButton onClick={handleAddCart}>åŠ å…¥è´­ç‰©è½¦</AuthButton>
<AuthButton onClick={handleFollow}>å…³æ³¨</AuthButton>
```

### âœ… ä½¿ç”¨ useAuth Hook çš„åœºæ™¯

- **éæŒ‰é’®å…ƒç´ **çš„ç‚¹å‡»äº‹ä»¶
- éœ€è¦**çµæ´»æ§åˆ¶é‰´æƒé€»è¾‘**çš„åœºæ™¯
- **è‡ªå®šä¹‰ç»„ä»¶**å†…éƒ¨çš„é‰´æƒ
- ä¸ä»‹æ„**è·³è½¬åˆ°ç™»å½•é¡µ**çš„åœºæ™¯

**ç¤ºä¾‹**:

```tsx
// âœ… æ¨èï¼šéæŒ‰é’®åœºæ™¯ä½¿ç”¨ useAuth
const { checkAuth } = useAuth();

<Image onClick={async () => {
  await checkAuth(() => {
    Taro.previewImage({...});
  });
}} />

<View onClick={async () => {
  await checkAuth(() => {
    nav.to('/pages/detail/index');
  });
}}>
  {content}
</View>
```

### å¯¹æ¯”è¡¨

| ç‰¹æ€§     | AuthButton     | useAuth Hook     |
| -------- | -------------- | ---------------- |
| é€‚ç”¨åœºæ™¯ | æŒ‰é’®ç‚¹å‡»       | ä»»ä½•å…ƒç´ ç‚¹å‡»     |
| æˆæƒæ–¹å¼ | å½“å‰é¡µç›´æ¥æˆæƒ | è·³è½¬ç™»å½•é¡µæˆæƒ   |
| ç”¨æˆ·ä½“éªŒ | æ— è·³è½¬ï¼Œæµç•…   | æœ‰è·³è½¬ï¼Œç»Ÿä¸€å…¥å£ |
| å­¦ä¹ æˆæœ¬ | ä½             | ä½               |
| çµæ´»æ€§   | ä»…é€‚ç”¨äºæŒ‰é’®   | é€‚ç”¨äºæ‰€æœ‰åœºæ™¯   |
| ä»£ç é‡   | å°‘             | ç•¥å¤š             |

---

## ç™»å½•æµç¨‹

### ç¬¬ä¸€é˜¶æ®µï¼šå°ç¨‹åºå¯åŠ¨æ—¶ï¼ˆè‡ªåŠ¨æ‰§è¡Œï¼‰

**ä½ç½®**ï¼š`src/app.ts` çš„ `useLaunch` é’©å­

```typescript
useLaunch(async () => {
  // 1. è·å–å¾®ä¿¡ login code
  const { code } = await Taro.login();

  // 2. è°ƒç”¨åç«¯æ¥å£
  const res = await userService.login({ code });

  // 3. åˆ¤æ–­ç”¨æˆ·çŠ¶æ€
  if (res.needBindPhone) {
    // æ–°ç”¨æˆ·ï¼šä¿å­˜ openId/unionIdï¼Œç­‰å¾…åç»­ç»‘å®š
    saveWxIdentity(res.openId, res.unionId);
  } else {
    // è€ç”¨æˆ·ï¼šç›´æ¥ç™»å½•æˆåŠŸ
    login(res.token, res.data);
  }
});
```

**è¯´æ˜**ï¼š

- è€ç”¨æˆ·æ‰“å¼€å°ç¨‹åºåï¼Œè‡ªåŠ¨å®Œæˆç™»å½•ï¼Œ`token` ä¿å­˜è‡³ Store
- æ–°ç”¨æˆ·æš‚å­˜ `openId/unionId`ï¼Œç­‰å¾…åœ¨ä¸šåŠ¡æ“ä½œæ—¶è§¦å‘æ‰‹æœºå·æˆæƒ

---

### ç¬¬äºŒé˜¶æ®µï¼šä¸šåŠ¡æ“ä½œæ—¶ï¼ˆæŒ‰éœ€è§¦å‘ï¼‰

**ä½¿ç”¨ `AuthButton` ç»„ä»¶å¤„ç†éœ€è¦ç™»å½•çš„æ“ä½œ**

```tsx
import { AuthButton } from "@/components";

function ProductDetail() {
  const handleAddCart = () => {
    // è¿™é‡Œçš„ä»£ç åªåœ¨å·²ç™»å½•æ—¶æ‰§è¡Œ
    console.log("åŠ å…¥è´­ç‰©è½¦");
  };

  return <AuthButton onClick={handleAddCart}>åŠ å…¥è´­ç‰©è½¦</AuthButton>;
}
```

**å·¥ä½œæœºåˆ¶**ï¼š

- **å·²ç™»å½•**ï¼šç›´æ¥è§¦å‘ `onClick` å›è°ƒ
- **æœªç™»å½•**ï¼šè‡ªåŠ¨å¼¹å‡ºå¾®ä¿¡æ‰‹æœºå·æˆæƒï¼ŒæˆæƒæˆåŠŸåæ‰§è¡Œ `onClick`

---

## AuthButton ç»„ä»¶

### åŸºç¡€ç”¨æ³•

```tsx
<AuthButton onClick={handleBuy}>ç«‹å³è´­ä¹°</AuthButton>
```

### ä½¿ç”¨ NutUI æ ·å¼

```tsx
<AuthButton useNutUI type="primary" block onClick={handleBuy}>
  ç«‹å³è´­ä¹°
</AuthButton>
```

### å®Œæ•´ç¤ºä¾‹

```tsx
import { View } from "@tarojs/components";
import { AuthButton } from "@/components";
import Taro from "@tarojs/taro";

function OrderPage() {
  const handleSubmitOrder = async () => {
    // ç”¨æˆ·å·²ç™»å½•ï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨æ¥å£
    const res = await orderService.submit();
    Taro.showToast({ title: "è®¢å•æäº¤æˆåŠŸ" });
  };

  return (
    <View className="p-4">
      <AuthButton useNutUI type="primary" block onClick={handleSubmitOrder}>
        æäº¤è®¢å•
      </AuthButton>
    </View>
  );
}
```

### Props è¯´æ˜

| å‚æ•°      | è¯´æ˜                         | ç±»å‹                              | é»˜è®¤å€¼      |
| --------- | ---------------------------- | --------------------------------- | ----------- |
| children  | æŒ‰é’®å†…å®¹                     | `ReactNode`                       | -           |
| onClick   | ç‚¹å‡»å›è°ƒï¼ˆä»…åœ¨å·²ç™»å½•æ—¶è§¦å‘ï¼‰ | `() => void`                      | -           |
| useNutUI  | æ˜¯å¦ä½¿ç”¨ NutUI Button æ ·å¼   | `boolean`                         | `false`     |
| type      | NutUI æŒ‰é’®ç±»å‹               | `'primary'` \| `'default'` \| ... | `'primary'` |
| className | è‡ªå®šä¹‰æ ·å¼ç±»                 | `string`                          | `''`        |
| disabled  | æ˜¯å¦ç¦ç”¨                     | `boolean`                         | `false`     |
| loading   | æ˜¯å¦åŠ è½½ä¸­                   | `boolean`                         | `false`     |
| block     | æ˜¯å¦å—çº§æŒ‰é’®                 | `boolean`                         | `false`     |

---

## é€‚ç”¨åœºæ™¯

### âœ… é€‚åˆä½¿ç”¨ AuthButton çš„åœºæ™¯

- åŠ å…¥è´­ç‰©è½¦
- ç«‹å³è´­ä¹°
- æ”¶è—å•†å“
- å…³æ³¨ç”¨æˆ·
- å‘è¡¨è¯„è®º
- æäº¤è®¢å•
- æŸ¥çœ‹æˆ‘çš„è®¢å•
- ä¿®æ”¹ä¸ªäººä¿¡æ¯

### âŒ ä¸é€‚åˆçš„åœºæ™¯

- æµè§ˆå•†å“åˆ—è¡¨ï¼ˆæ— éœ€ç™»å½•ï¼‰
- æŸ¥çœ‹å•†å“è¯¦æƒ…ï¼ˆæ— éœ€ç™»å½•ï¼‰
- è”ç³»å®¢æœï¼ˆæ— éœ€ç™»å½•ï¼‰
- åˆ†äº«åŠŸèƒ½ï¼ˆä¸ `open-type="share"` å†²çªï¼‰

---

## ç™»å½•é¡µçš„å®šä½

è™½ç„¶é‡‡ç”¨äº†"æ— ç™»å½•é¡µ"æ¨¡å¼ï¼Œä½† `src/pages/login/index.tsx` ä¾ç„¶ä¿ç•™ï¼Œç”¨äºä»¥ä¸‹åœºæ™¯ï¼š

### 1. å¼‚å¸¸å…œåº•

- ç½‘ç»œå¼‚å¸¸å¯¼è‡´é™é»˜ç™»å½•å¤±è´¥
- Token è¿‡æœŸéœ€è¦é‡æ–°ç™»å½•
- ç”¨æˆ·ä¸»åŠ¨é€€å‡ºç™»å½•å

### 2. åŠŸèƒ½æ‰©å±•

- æœªæ¥å¯èƒ½æ·»åŠ è´¦å·å¯†ç ç™»å½•
- æœªæ¥å¯èƒ½æ·»åŠ ç¬¬ä¸‰æ–¹ç™»å½•ï¼ˆå¾®ä¿¡ã€æ”¯ä»˜å®ç­‰ï¼‰
- æœªæ¥å¯èƒ½æ·»åŠ éªŒè¯ç ç™»å½•

### 3. å“ç‰Œå±•ç¤º

- é¦–æ¬¡è¿›å…¥çš„æ¬¢è¿é¡µ
- è¥é”€æ´»åŠ¨å…¥å£
- ç”¨æˆ·å¼•å¯¼

### 4. ä¸»åŠ¨è·³è½¬åœºæ™¯

å½“éœ€è¦å¼ºåˆ¶ç”¨æˆ·ç™»å½•æ—¶ï¼Œå¯ä»¥æ‰‹åŠ¨è·³è½¬ï¼š

```typescript
// ç¤ºä¾‹ï¼šè¿›å…¥ä¸ªäººä¸­å¿ƒå‰æ£€æŸ¥ç™»å½•çŠ¶æ€
function checkLoginAndNavigate() {
```typescript
import { MAIN_ROUTES } from '@/constants/routes';

  const { token } = useUserStore.getState();
  if (!token) {
    Taro.navigateTo({ url: MAIN_ROUTES.LOGIN });
    return;
  }
  // å·²ç™»å½•ï¼Œç»§ç»­æ“ä½œ...
}
```

---

## åç«¯æ¥å£è¦æ±‚

### 1. é™é»˜ç™»å½•æ¥å£

**è·¯å¾„**ï¼š`POST /user/login`

**è¯·æ±‚å‚æ•°**ï¼š

```typescript
{
  code: string; // å¾®ä¿¡ login code
}
```

**å“åº”**ï¼š

```typescript
// è€ç”¨æˆ·ï¼ˆæœ‰æ‰‹æœºå·ï¼‰
{
  token: string;
  data: UserInfo;
  needBindPhone: false;
}

// æ–°ç”¨æˆ·ï¼ˆæ— æ‰‹æœºå·ï¼‰
{
  openId: string;
  unionId?: string;
  needBindPhone: true;
}
```

### 2. æ‰‹æœºå·ç™»å½•/ç»‘å®šæ¥å£

**è·¯å¾„**ï¼š`POST /wxMn/phoneLogin`

**è¯·æ±‚å‚æ•°**ï¼š

```typescript
{
  phoneCode: string;      // æ‰‹æœºå·æˆæƒ code
  openId?: string;        // æ–°ç”¨æˆ·ç»‘å®šæ—¶éœ€è¦
  unionId?: string;       // æ–°ç”¨æˆ·ç»‘å®šæ—¶éœ€è¦ï¼ˆå¯é€‰ï¼‰
}
```

**å“åº”**ï¼š

```typescript
{
  token: string;
  data: UserInfo;
}
```

---

## å¼€å‘å»ºè®®

### 1. ä¼˜å…ˆä½¿ç”¨ AuthButton

åœ¨æ‰€æœ‰éœ€è¦ç™»å½•çš„ä¸šåŠ¡æ“ä½œä¸­ï¼Œä¼˜å…ˆä½¿ç”¨ `AuthButton` è€Œéæ‰‹åŠ¨åˆ¤æ–­ï¼š

```tsx
// âŒ ä¸æ¨èï¼šæ‰‹åŠ¨åˆ¤æ–­
const handleBuy = () => {
  const { token } = useUserStore();
  if (!token) {
    Taro.showToast({ title: "è¯·å…ˆç™»å½•" });
    return;
  }
  // ä¸šåŠ¡é€»è¾‘...
};

// âœ… æ¨èï¼šä½¿ç”¨ AuthButton
<AuthButton onClick={handleBuy}>ç«‹å³è´­ä¹°</AuthButton>;
```

### 2. æµ‹è¯•æ–°è€ç”¨æˆ·æµç¨‹

**æµ‹è¯•æ–°ç”¨æˆ·æµç¨‹**ï¼š

1. å¾®ä¿¡å¼€å‘è€…å·¥å…· â†’ æ¸…é™¤ç¼“å­˜
2. ç‚¹å‡»ç¼–è¯‘
3. ç‚¹å‡»éœ€è¦ç™»å½•çš„æŒ‰é’®
4. åº”å¼¹å‡ºæ‰‹æœºå·æˆæƒå¼¹çª—

**æµ‹è¯•è€ç”¨æˆ·æµç¨‹**ï¼š

1. å®Œæˆä¸Šè¿°æ–°ç”¨æˆ·æµç¨‹
2. å…³é—­å°ç¨‹åºï¼ˆä¸æ¸…é™¤ç¼“å­˜ï¼‰
3. é‡æ–°æ‰“å¼€å°ç¨‹åº
4. ç‚¹å‡»éœ€è¦ç™»å½•çš„æŒ‰é’®
5. åº”ç›´æ¥æ‰§è¡Œä¸šåŠ¡é€»è¾‘ï¼Œæ— å¼¹çª—

### 3. æ—¥å¿—è°ƒè¯•

é¡¹ç›®å·²é›†æˆå½©è‰²æ—¥å¿—å·¥å…·ï¼Œç™»å½•ç›¸å…³æ—¥å¿—ä¼šè‡ªåŠ¨è¾“å‡ºï¼š

```
ğŸš€ å°ç¨‹åºå¯åŠ¨ - å¼€å§‹é™é»˜ç™»å½•æ£€æŸ¥
ğŸ”‘ è·å–åˆ°å¾®ä¿¡ code: 071abc...
âœ… è€ç”¨æˆ·é™é»˜ç™»å½•æˆåŠŸ
```

æˆ–

```
âš ï¸  æ£€æµ‹åˆ°æ–°ç”¨æˆ·ï¼Œéœ€è¦ç»‘å®šæ‰‹æœºå·
ğŸ’¾ å·²ä¿å­˜ openId/unionIdï¼Œç­‰å¾…ç”¨æˆ·æ‰‹åŠ¨ç™»å½•
ğŸ“± æ–°ç”¨æˆ·ç»‘å®šæ‰‹æœºå·
```

---

## å¸¸è§é—®é¢˜

### Q1: ä¸ºä»€ä¹ˆè€ç”¨æˆ·æ¯æ¬¡æ‰“å¼€éƒ½è¦ç­‰å¾…ç™»å½•ï¼Ÿ

**A**: æ­£å¸¸æƒ…å†µä¸‹ï¼Œè€ç”¨æˆ·çš„ `token` ä¼šæŒä¹…åŒ–åˆ°æœ¬åœ°ç¼“å­˜ã€‚å¦‚æœæ¯æ¬¡éƒ½è§¦å‘ç™»å½•ï¼Œæ£€æŸ¥ï¼š

1. `src/store/user.ts` çš„ `persist` é…ç½®æ˜¯å¦æ­£ç¡®
2. åç«¯ token æ˜¯å¦è®¾ç½®äº†è¿‡æœŸæ—¶é—´

### Q2: æ–°ç”¨æˆ·æˆæƒåï¼Œä¸‹æ¬¡è¿˜ä¼šå¼¹çª—å—ï¼Ÿ

**A**: ä¸ä¼šã€‚æˆæƒæˆåŠŸåï¼Œ`token` ä¼šä¿å­˜åˆ° Store å’Œæœ¬åœ°ç¼“å­˜ï¼Œä¸‹æ¬¡ç›´æ¥ä½¿ç”¨ã€‚

### Q3: AuthButton å¯ä»¥åœ¨å¾ªç¯ä¸­ä½¿ç”¨å—ï¼Ÿ

**A**: å¯ä»¥ï¼Œä½†éœ€è¦æ³¨æ„ `onClick` çš„å‚æ•°åŒ–ï¼š

```tsx
{
  products.map((item) => (
    <AuthButton key={item.id} onClick={() => handleBuy(item.id)}>
      è´­ä¹°
    </AuthButton>
  ));
}
```

### Q4: å¦‚ä½•å¼ºåˆ¶ç”¨æˆ·é‡æ–°ç™»å½•ï¼Ÿ

**A**: è°ƒç”¨ `useUserStore` çš„ `logout` æ–¹æ³•ï¼š

```typescript
const { logout } = useUserStore();
logout(); // æ¸…é™¤ token å’Œç”¨æˆ·ä¿¡æ¯
```

---

## ç›¸å…³æ–‡æ¡£

- [AuthButton ç»„ä»¶æ–‡æ¡£](../src/components/AuthButton/README.md)
- [Zustand çŠ¶æ€ç®¡ç†ä½¿ç”¨æŒ‡å—](./ZustandçŠ¶æ€ç®¡ç†ä½¿ç”¨æŒ‡å—.md)
- [useRequest ä½¿ç”¨æŒ‡å—](./useRequestä½¿ç”¨æŒ‡å—.md)
